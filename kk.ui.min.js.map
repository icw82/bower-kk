{"version":3,"sources":["ui.js"],"names":[],"mappings":"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","file":"kk.ui.min.js","sourcesContent":["// Класс .hover и .pressed всем ссылкам на один и тот же документ\r\nkenzo.anchors = (function(){\r\n    // TODO: 'xlink:href'\r\n    var _ = {},\r\n        anchors = document.querySelectorAll('a[href]');\r\n\r\n    _.add = function(anchor){\r\n        try {\r\n            var url = anchor.getAttribute('href').replace(/[\\n\\r\\b\\t]/g, ''),\r\n                same = document.querySelectorAll('a[href=\"' + url + '\"]');\r\n\r\n            anchor.addEventListener('mouseover', function(){\r\n                each (same, function(o){\r\n                    (o.classList.contains('hover')) || (o.classList.add('hover'))\r\n                });\r\n            }, false);\r\n\r\n            anchor.addEventListener('mouseout', function(){\r\n                each (same, function(o){\r\n                    (o.classList.contains('hover')) && (o.classList.remove('hover'))\r\n                });\r\n            }, false);\r\n\r\n            anchor.addEventListener('mousedown', function(){\r\n                each (same, function(o){\r\n                    (o.classList.contains('pressed')) || (o.classList.add('pressed'))\r\n                });\r\n            }, false);\r\n\r\n            anchor.addEventListener('mouseup', function(){\r\n                each (same, function(o){\r\n                    (o.classList.contains('pressed')) && (o.classList.remove('pressed'))\r\n                });\r\n            }, false);\r\n        } catch (e){\r\n            console.warn(e);\r\n        }\r\n    }\r\n\r\n    each (anchors, _.add);\r\n\r\n    return _;\r\n})();\r\n\r\nkenzo.tabs = (function(){\r\n    var anchors = [],\r\n        panels = [],\r\n        preactivated_groups = [];\r\n\r\n    // Индексирование якоря или панели\r\n    var add = function(element){\r\n        if (!(element instanceof Element)) return false;\r\n\r\n        var anchor_name = element.getAttribute('data-kenzo-tab-anchor'),\r\n            group_name = element.getAttribute('data-kenzo-tab-group'),\r\n            panel_name = element.getAttribute('data-kenzo-tab-panel'),\r\n            exist = false;\r\n\r\n        if (group_name === '') group_name = null;\r\n\r\n        if (anchor_name){\r\n            each (anchors, function(item){\r\n                if ((anchor_name === item.name) && (group_name === item.group)){\r\n                    exist = true;\r\n                    item.dom.push(element);\r\n                    return true;\r\n                }\r\n            });\r\n\r\n            exist || anchors.push({\r\n                'name': anchor_name,\r\n                'group': group_name,\r\n                'dom': [element]\r\n            });\r\n\r\n            element.kenzo_anchor_name = anchor_name;\r\n            element.kenzo_group_name = group_name;\r\n            element.addEventListener('click', anchor_listner);\r\n\r\n            if (element.classList.contains('current')){\r\n                if (preactivated_groups.indexOf(group_name) > -1){\r\n                    element.classList.remove('current');\r\n                } else {\r\n                    preactivated_groups.push(group_name);\r\n                    show(anchor_name, group_name);\r\n                }\r\n            }\r\n        } else if (panel_name){\r\n            each (panels, function(item){\r\n                if ((panel_name === item.name) && (group_name === item.group)){\r\n                    exist = true;\r\n                    item.dom.push(element);\r\n                    return true;\r\n                }\r\n            });\r\n\r\n            exist || panels.push({\r\n                'name': panel_name,\r\n                'group': group_name,\r\n                'dom': [element]\r\n            });\r\n        }\r\n    }\r\n\r\n    var anchor_listner = function(event){\r\n        var anchor_search = function(child){\r\n            if (child.getAttribute('data-kenzo-tab-anchor'))\r\n                return child;\r\n            else if (child.parentNode !== document.body)\r\n                return anchor_search(child.parentNode);\r\n        }\r\n\r\n        var anchor = anchor_search(event.target),\r\n            name = anchor.kenzo_anchor_name,\r\n            group = anchor.kenzo_group_name;\r\n\r\n        if (!(anchor instanceof Element) || anchor.classList.contains('current')) return false;\r\n\r\n        each (anchors, function(item){\r\n            if (item.group === group){\r\n\r\n                if (item.name === name){\r\n                    each (item.dom, function(element){\r\n                        element.classList.add('current');\r\n                    });\r\n                } else {\r\n                    each (item.dom, function(element){\r\n                        element.classList.remove('current');\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        show(name, group);\r\n    }\r\n\r\n    var show = function(name, group){\r\n        if (typeof name != 'string') return false;\r\n        if (typeof group != 'string') group = null;\r\n\r\n        // TODO: prev and next;\r\n\r\n        each (panels, function(item){\r\n            if (item.group === group){\r\n                if (item.name === name){\r\n                    each (item.dom, function(element){\r\n                        element.classList.add('current');\r\n                    });\r\n                } else {\r\n                    each (item.dom, function(element){\r\n                        element.classList.remove('current');\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        kenzo.generate.resize();\r\n    }\r\n\r\n    // Панели\r\n    each ('[data-kenzo-tab-panel]', add);\r\n\r\n    // Якори\r\n    each ('[data-kenzo-tab-anchor]', add);\r\n\r\n    return {\r\n        'add': add,\r\n        'show': show\r\n    }\r\n})();\r\n\r\n\r\n/*\r\nwrapper — обёртка сайта, элемент .layout-wrapper.\r\n    Обычно имеет ширину отличную от ширины окна браузера.\r\nanchor — элемент-якорь.\r\nwindow — окно браузера.\r\n\r\nНастройки панели\r\n    data-kenzo-popup-panel {string}\r\n      — идентификатор (имя) панели\r\n    data-kenzo-option-mutex {string} (\"all\" | \"panel1 panel2 panelN\")\r\n      — при открытии панели закрываются другие панели, указанные в атрибуте\r\n    data-modal {boolean}\r\n      — подложка, блокирующая основное содержимое.\r\n        При открытии такого попапа все остальные попапы закрываются\r\n        вне зависимости от значений атрибута data-kenzo-option-mutex.\r\n        (false по умолчанию)\r\n    data-close-on-blur {boolean}\r\n      — закрывать попап по нажатию вне его.\r\n        (true по умолчанию)\r\n\r\n    data-width {string} (\"100\", \"40.5%\")\r\n      — ширина панели. Если в процентах, то относительно .layout-wrapper.\r\n        Значение с процентами будет преобразовано во Float;\r\n        если процента в конце строки нет, строка будет преобразована в Integer.\r\n    data-height {string} (\"100\", \"40.5%\")\r\n      — высота панели. Если в процентах, то относительно высоты окна.\r\n        Значение с процентами будет преобразовано во Float;\r\n        если процента в конце строки нет, строка будет преобразована в Integer.\r\n\r\n    FURURE: условия привести в порядок.\r\n\r\n    data-rel-x {string} (\"wrapper\" | \"anchor\" | \"window\")\r\n      — относительно чего распологать попап по оси X\r\n        (\"anchor\" по умолчанию) (приоритет над data-rel)\r\n    data-rel-y {string} (\"wrapper\" | \"anchor\" | \"window\")\r\n      — относительно чего распологать попап по оси Y\r\n        (\"anchor\" по умолчанию) (приоритет над data-rel)\r\n    data-rel {string} (\"wrapper\" | \"anchor\" | \"window\")\r\n      — относительно чего распологать попап.\r\n        Краткая запись для data-rel-left=\"\" и data-rel-top=\"\". Например:\r\n        data-rel=\"window\"         = data-rel-x=\"window\"  и data-rel-y=\"window\",\r\n        data-rel=\"wrapper anchor\" = data-rel-x=\"wrapper\" и data-rel-y=\"anchor\",\r\n\r\n//    data-pos-x {string} (\"left\" | \"center\" | \"right\") center\r\n//      — позиционирование панели относительно выбранного объекта\r\n//    data-pos-y {string} (\"top\" | \"center\" | \"bottom\") top\r\n//      — позиционирование панели относительно выбранного объекта\r\n//\r\n//    data-align-x {string} (\"left\" | \"center\" | \"right\") center\r\n//      — выравнивание панели\r\n//    data-align-y {string} (\"top\" | \"center\" | \"bottom\") top\r\n//      — выравнивание панели\r\n\r\n    FUTURE: data-auto-open, data-auto-close\r\n\r\nDeprecated:\r\n    data-kenzo-option-left {boolean}\r\n      — если true синоним для data-rel-x=\"anchor\"\r\n        если false синоним для data-rel-x=\"wrapper\"\r\n    data-kenzo-option-top {boolean}\r\n      — если true синоним для data-rel-y=\"anchor\"\r\n        если false синоним для data-rel-y=\"wrapper\"\r\n    data-temp-center = true\r\n      — Распологать панель по центру экрана.\r\n\r\nDeleted:\r\n\r\n*/\r\n// Только для именованных якорей и панелей\r\nkenzo.popup = (function(){\r\n    if (!kenzo.toplayer) return false;\r\n\r\n    var popup_layer = kenzo.toplayer.get_popup_layer(),\r\n        panels = [],\r\n        current = [],\r\n        block_hide = false;\r\n\r\n    var default_options = {\r\n        mutex: false, // значение по умолчанию не используется\r\n        modal: false,\r\n        close_on_blur: true,\r\n        width: { // значение по умолчанию не используется\r\n            value: 320,\r\n            units: 'px'\r\n        },\r\n        height: { // значение по умолчанию не используется\r\n            value: null,\r\n            units: 'auto'\r\n        },\r\n        rel: {\r\n            x: 'anchor',\r\n            y: 'anchor'\r\n        },\r\n        pos: {\r\n            x: 'center',\r\n            y: 'top'\r\n        },\r\n    };\r\n\r\n    if (!(popup_layer instanceof Element)) return false;\r\n\r\n    var get_option__bool = function(element, attribute, default_value){\r\n        var data = element.getAttribute(attribute);\r\n\r\n        if (typeof default_value == 'undefined')\r\n            default_value = false;\r\n\r\n        if (data === 'true')\r\n            return true;\r\n        else if (data === 'false')\r\n            return false;\r\n        else\r\n            return default_value || false;\r\n    }\r\n\r\n    var get_value = function(element, attribute){\r\n        var _ = {},\r\n            data = element.getAttribute(attribute);\r\n\r\n        if (data === null) return null;\r\n\r\n        _.value = data.match(/([\\d]+\\.[\\d]+|[\\d]+)%/);\r\n        if (_.value !== null)\r\n            _.units = '%';\r\n        else {\r\n            _.value = data.match(/(\\d+)/);\r\n\r\n            if (_.value !== null)\r\n                _.units = 'px';\r\n            else\r\n                return null;\r\n        }\r\n\r\n        _.value = parseFloat(_.value[1]);\r\n\r\n        return _;\r\n    }\r\n\r\n    var get_panel_option_rel = function(panel){\r\n        var _ = {},\r\n            options = ['wrapper', 'anchor', 'window'];\r\n\r\n        var x = panel.getAttribute('data-rel-x'),\r\n            y = panel.getAttribute('data-rel-y');\r\n\r\n        if ((x !== null) && (options.indexOf(x) === -1)) x = null;\r\n        if ((y !== null) && (options.indexOf(y) === -1)) y = null;\r\n\r\n        if (!x || !y){\r\n            var rel = panel.getAttribute('data-rel');\r\n\r\n            if (rel !== null){\r\n                rel = rel\r\n                    .replace(/,+/g, ' ')\r\n                    .replace(/\\s{2,}/g, ' ')\r\n                    .split(' ');\r\n\r\n                if (rel.length === 1)\r\n                     rel[1] = rel[0];\r\n\r\n                if (options.indexOf(rel[0]) === -1)\r\n                    rel[0] = null;\r\n                if (options.indexOf(rel[1]) === -1)\r\n                    rel[1] = null;\r\n            }\r\n        }\r\n\r\n        _.x = x || (rel ? rel[0] : null);\r\n        _.y = y || (rel ? rel[1] : null);\r\n\r\n        // Old way\r\n        if (!_.x){\r\n            var left = panel.getAttribute('data-kenzo-option-left');\r\n            if (left !== null) {\r\n                if (left === 'true')\r\n                    _.x = 'anchor';\r\n                else if (left === 'false')\r\n                    _.x = 'wrapper';\r\n            }\r\n        }\r\n\r\n        if (!_.y){\r\n            var top = panel.getAttribute('data-kenzo-option-top');\r\n\r\n            if (top !== null){\r\n                if (top === 'true')\r\n                    _.y = 'anchor';\r\n                else if (top === 'false')\r\n                    _.y = 'wrapper';\r\n            }\r\n        }\r\n\r\n        // Defaults\r\n        if (!_.x) _.x = default_options.rel.x;\r\n        if (!_.y) _.y = default_options.rel.y;\r\n\r\n        return _;\r\n    }\r\n\r\n    var get_panel_option_pos = function(panel){\r\n        var _ = {},\r\n            options_x = ['left', 'center', 'right'],\r\n            options_y = ['top', 'center', 'bottom'];\r\n\r\n        var x = panel.getAttribute('data-pos-x'),\r\n            y = panel.getAttribute('data-pos-y');\r\n\r\n        if ((x !== null) && (options_x.indexOf(x) === -1)) x = null;\r\n        if ((y !== null) && (options_y.indexOf(y) === -1)) y = null;\r\n\r\n        if (!x || !y){\r\n            var pos = panel.getAttribute('data-pos');\r\n\r\n            if (pos !== null){\r\n                pos = pos\r\n                    .replace(/,+/g, ' ')\r\n                    .replace(/\\s{2,}/g, ' ')\r\n                    .split(' ');\r\n\r\n                if (pos.length === 1)\r\n                    pos[1] = pos[0];\r\n\r\n                if (options_x.indexOf(pos[0]) === -1)\r\n                    pos[0] = null;\r\n                if (options_y.indexOf(pos[1]) === -1)\r\n                    pos[1] = null;\r\n            }\r\n        }\r\n\r\n        _.x = x || (pos ? pos[0] : null);\r\n        _.y = y || (pos ? pos[1] : null);\r\n\r\n        // Defaults\r\n        if (!_.x) _.x = default_options.pos.x;\r\n        if (!_.y) _.y = default_options.pos.y;\r\n\r\n        return _;\r\n    }\r\n\r\n    var get_panel_options = function(panel){\r\n        var _ = {};\r\n\r\n        _.mutex = (function(){\r\n            var data = panel.getAttribute('data-kenzo-option-mutex');\r\n\r\n            if (data){\r\n                data = data.replace(/,+/g, ' ').replace(/\\s{2,}/g, ' ');\r\n                return data.split(' ');\r\n            }\r\n            // FUTURE: all, исключения\"\r\n        })();\r\n\r\n        _.modal = get_option__bool(panel, 'data-modal', default_options.modal);\r\n        _.close_on_blur =\r\n            get_option__bool(panel, 'data-close-on-blur', default_options.close_on_blur);\r\n\r\n        _.width = get_value(panel, 'data-width');\r\n        _.height = get_value(panel, 'data-height');\r\n        _.rel = get_panel_option_rel(panel);\r\n        _.pos = get_panel_option_pos(panel);\r\n\r\n        _.temp_center = get_option__bool(panel, 'data-temp-center', false);\r\n\r\n        if (_.temp_center){\r\n            _.rel.x = 'window';\r\n            _.rel.y = 'window';\r\n        }\r\n        // ?\r\n//        if (_.modal === true)\r\n//            _.mutex = ['all'];\r\n\r\n        return _;\r\n    }\r\n\r\n    var get_panel_object = function(name, panel){\r\n        var stat = {\r\n            'name': name,\r\n            'dom': panel,\r\n            'show': false,\r\n            'anchor': null,\r\n            'anchor_clones': [],\r\n            'anchor_clones_wrapper':\r\n                panel.querySelector('[data-kenzo-popup-anchor-clone=\"' + name + '\"]'),\r\n            'pointer': (function(){\r\n                return panel.querySelector('[data-kenzo-popup-pointer=\"' + name + '\"]');\r\n            })(),\r\n            'options': get_panel_options(panel),\r\n            'update': {\r\n                'width': true,\r\n                'height': true\r\n            }\r\n        }\r\n\r\n        return stat;\r\n    };\r\n\r\n    // Индексирование и перемещение Панели в верхний слой\r\n    var add = function(panel){\r\n        var name = panel.getAttribute('data-kenzo-popup-panel');\r\n\r\n        if (name !== ''){\r\n            each (panels, function(item){\r\n                if (item.name === name){\r\n                    console.warn('Две или более одноимённых панелей:', name);\r\n                    return true;\r\n                }\r\n            }, function(){\r\n                // Если панель с таким именем ещё не индексирована, она индексируется.\r\n                panels.push( get_panel_object(name, panel) );\r\n            });\r\n        }\r\n\r\n        popup_layer.appendChild(panel);\r\n    }\r\n\r\n    var get = function(){\r\n        var panel, name, element;\r\n\r\n        if (typeof arguments[0] === 'string')\r\n            name = arguments[0];\r\n        else if (arguments[0] instanceof Element){\r\n            element = arguments[0];\r\n            name =\r\n                element.getAttribute('data-kenzo-popup-anchor') ||\r\n                element.getAttribute('data-kenzo-popup-close') ||\r\n                element.getAttribute('data-kenzo-popup-close-button');\r\n        }\r\n\r\n        if (!name || name === '') return panel;\r\n\r\n        // В Array.forEach нет остановки итерации\r\n        each (panels, function(item){\r\n            if (item.name === name){\r\n                panel = item;\r\n                return true;\r\n            }\r\n        });\r\n\r\n        return panel;\r\n    }\r\n\r\n    var update_sizes = function(panel){\r\n        var _ = {\r\n            width: panel.options.width,\r\n            height: panel.options.height\r\n        };\r\n\r\n        if (panel.update.width && _.width && _.width.value > 0){\r\n            panel.dom.style.width = _.width.value + _.width.units;\r\n            panel.update.width = false;\r\n        }\r\n\r\n        if (panel.update.height && _.height && _.height.value > 0){\r\n            if (_.height.units === 'px'){\r\n                panel.dom.style.height = _.height.value + _.height.units;\r\n                panel.update.height = false;\r\n            } else if (_.height.units === '%'){\r\n                panel.dom.style.height = getWindowParams().h / 100 * _.height.value + 'px';\r\n            }\r\n        }\r\n    }\r\n\r\n    var update_position = function(panel){\r\n        var wrapper = popup_layer.getBoundingClientRect(),\r\n            _ = {\r\n                width: panel.options.width,\r\n                height: panel.options.height,\r\n                rel: panel.options.rel,\r\n                pos: panel.options.pos\r\n            };\r\n\r\n        if (panel.anchor instanceof Element)\r\n            var anchor = panel.anchor.getOffset();\r\n\r\n        if (_.width && _.width.value > 0){\r\n\r\n            // center top\r\n            if (panel.dom.classList.contains('std'))\r\n                panel.dom.style.marginLeft = -Math.round(_.width.value/2) + _.width.units;\r\n        }\r\n\r\n        // NOTE: временно\r\n        if (panel.options.temp_center){\r\n            var scroll_top = getWindowParams().y,\r\n                client_height = getWindowParams().h;\r\n\r\n            panel.dom.style.left = '50%';\r\n            panel.dom.style.top = scroll_top\r\n                + ( (client_height - panel.dom.offsetHeight)/2 ) + 'px';\r\n        }\r\n\r\n//        if (_.rel.x === 'window'){ }\r\n//        if (_.rel.y === 'window'){ }\r\n\r\n        if ((_.rel.x === 'anchor') && anchor){\r\n            var left = anchor.left - wrapper.left + anchor.width/2;\r\n            panel.dom.style.left = left + 'px';\r\n            var panel_left = panel.dom.getBoundingClientRect().left - wrapper.left;\r\n\r\n            if (panel_left + panel.dom.offsetWidth > wrapper.width - 10){\r\n                panel.dom.style.removeProperty('left');\r\n                panel.dom.style.right = '10px';\r\n            } else if (panel_left < 10){\r\n                panel.dom.style.left = Math.round(panel.dom.offsetWidth/2) + 10 + 'px';\r\n            }\r\n        }\r\n\r\n        if ((_.rel.y === 'anchor') && anchor){\r\n            var top = anchor.top + anchor.height;\r\n            panel.dom.style.top = top + 'px';\r\n        }\r\n    }\r\n\r\n    var update_pointer = function(panel){\r\n        var panel_offset = panel.dom.getOffset();\r\n\r\n        if (panel.anchor instanceof Element)\r\n            var anchor = panel.anchor.getOffset();\r\n\r\n        if (anchor){\r\n            if (panel.pointer){\r\n                panel.pointer.style.left =\r\n                    (anchor.left + anchor.width/2 - panel_offset.left) + 'px';\r\n            }\r\n\r\n            if (panel.anchor_clones_wrapper){\r\n                panel.anchor_clones_wrapper.style.left =\r\n                    (anchor.left - panel_offset.left) + 'px';\r\n\r\n                panel.anchor_clones_wrapper.style.top =\r\n                    (anchor.top - panel_offset.top) + 'px';\r\n            }\r\n        }\r\n    }\r\n\r\n    var update = function(){\r\n        each (current, function(panel){\r\n            if (!panel.show) return false;\r\n\r\n//            if (panel.anchor instanceof Element)\r\n//                var anchor = panel.anchor.getOffset();\r\n//            else\r\n//                return false;\r\n\r\n            update_sizes(panel);\r\n            update_position(panel);\r\n            update_pointer(panel);\r\n\r\n        });\r\n    }\r\n\r\n    window.addEventListener('resize', update, true);\r\n\r\n    // В качестве первого аргумента можно указывать якорь, название панели\r\n    // или саму панель (элемент).\r\n    // Если второй аргумент является элементом, то он указывается как якорь.\r\n    // Если второй или третий аргумент имеют значение false, то якорь,\r\n    // если он есть, не будет становиться активным (останется без класса .active).\r\n    var show = function(){\r\n        var panel = get(arguments[0]),\r\n            active = true,\r\n            anchor, current_clone;\r\n\r\n        if (!panel) return false;\r\n\r\n        if (arguments[0] instanceof Element){\r\n            if (arguments[0] !== panel.dom)\r\n                anchor = arguments[0];\r\n        } else if (arguments[1] instanceof Element){\r\n            anchor = arguments[1];\r\n\r\n            if (typeof arguments[2] == 'boolean'){\r\n                active = arguments[2];\r\n            }\r\n        } else if (typeof arguments[1] == 'boolean'){\r\n            active = arguments[1];\r\n        }\r\n\r\n        block_hide = true;\r\n\r\n        if (panel.options.mutex instanceof Array){\r\n            if (panel.options.mutex.indexOf('all') > -1){\r\n                each (current, function(item){\r\n                    hide(item.name);\r\n                });\r\n            } else {\r\n                each (panel.options.mutex, function(name){\r\n                    hide(name);\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n        if (anchor){\r\n            panel.anchor = anchor;\r\n\r\n            if (panel.anchor_clones_wrapper){\r\n                current_clone = null;\r\n                each (panel.anchor_clones, function(clone){\r\n                    if (clone.original === panel.anchor){\r\n                        current_clone = clone.dom;\r\n                    } else {\r\n                        clone.dom.style.display = 'none';\r\n                    }\r\n                });\r\n\r\n                if (!current_clone){\r\n                    var current_clone = anchor.cloneNode(true);\r\n                    current_clone = init_anchor(anchor, panel.name).clone;\r\n                }\r\n\r\n                current_clone.style.removeProperty('display');\r\n                current_clone.classList.remove('active');\r\n            }\r\n        }\r\n\r\n        if (panel.options.modal === true)\r\n            kenzo.toplayer.show(true);\r\n\r\n        panel.dom.classList.add('visible');\r\n        panel.show = true;\r\n\r\n        each (current, function(item){\r\n            if (item == panel)\r\n                return true;\r\n        }, function(){\r\n            current.push(panel);\r\n        });\r\n\r\n        update();\r\n\r\n        var first_field = panel.dom.querySelector('input, textarea');\r\n        if (first_field instanceof Element)\r\n            first_field.focus();\r\n\r\n        if (active && current_clone) current_clone.classList.add('active');\r\n        if (active && anchor) anchor.classList.add('active');\r\n    }\r\n\r\n    var hide = function(){\r\n        var panel = get(arguments[0]),\r\n            blur = arguments[1];\r\n\r\n        if (typeof blur !== 'boolean')\r\n            blur = false;\r\n\r\n        if (!panel || !panel.show) return false;\r\n\r\n        if (!panel.options.close_on_blur && blur) return false;\r\n\r\n        if (panel.anchor){\r\n            panel.anchor.classList.remove('active');\r\n            panel.anchor = null;\r\n        }\r\n\r\n        panel.dom.classList.remove('visible');\r\n        panel.show = false;\r\n\r\n        if (panel.options.modal === true)\r\n            kenzo.toplayer.hide();\r\n\r\n        each (current, function(item, i){\r\n            if (item == panel)\r\n                current.splice(i, 1);\r\n        });\r\n    }\r\n\r\n    // FUTURE: toggle\r\n\r\n    var init_anchor = function(anchor){\r\n        if (arguments[0] instanceof Element)\r\n            var panel = get(arguments[0]);\r\n\r\n        if (typeof arguments[1] == 'string')\r\n            var steppanel = get(arguments[1]);\r\n\r\n        if (!panel) return false;\r\n\r\n        var clone;\r\n\r\n        var onclick = function(event){\r\n            if ((panel.show === false) || (panel.anchor !== anchor)){\r\n                show(anchor);\r\n            } else {\r\n                hide(anchor);\r\n            }\r\n        }\r\n\r\n        if (!('kz-initiated' in anchor)){\r\n            anchor.addEventListener('click', onclick);\r\n            anchor['kz-initiated'] = true;\r\n        }\r\n\r\n        // Клонирование якоря\r\n        if (panel.anchor_clones_wrapper){\r\n            clone = anchor.cloneNode(true);\r\n            var newobj = {\r\n                'original': anchor,\r\n                'dom': clone\r\n            };\r\n\r\n            if (steppanel){\r\n                steppanel.anchor_clones.push(newobj);\r\n                steppanel.anchor_clones_wrapper.appendChild(clone);\r\n            } else{\r\n                panel.anchor_clones.push(newobj);\r\n                panel.anchor_clones_wrapper.appendChild(clone);\r\n            }\r\n\r\n            clone.addEventListener('click', onclick);\r\n        }\r\n\r\n        return {\r\n            'anchor': anchor,\r\n            'clone': clone\r\n        }\r\n    }\r\n\r\n    // Панели\r\n    each ('[data-kenzo-popup-panel]', add);\r\n\r\n    // Якори\r\n    each ('[data-kenzo-popup-anchor]', function(item, i){\r\n        // Костыль для инвалида IE\r\n        if ((typeof item.classList === 'undefined') && (item instanceof SVGSVGElement)){\r\n            var wrapper = document.createElement('span');\r\n            item.parentNode.insertBefore(wrapper, item);\r\n            wrapper.appendChild(item);\r\n            wrapper.setAttribute(\r\n                'data-kenzo-popup-anchor',\r\n                item.getAttribute('data-kenzo-popup-anchor')\r\n            );\r\n            init_anchor(wrapper, i);\r\n        } else\r\n            init_anchor(item, i);\r\n    });\r\n\r\n    // Проводники\r\n    // Проводит событие 'click' в первый одноимённый якорь в элементах блока\r\n    each ('[data-kenzo-popup-conductor]', function(conductor){\r\n        var name = conductor.getAttribute('data-kenzo-popup-conductor');\r\n\r\n        if (name === '')\r\n            name = null;\r\n        else {\r\n            var panel = get(name);\r\n            if (!panel) return false;\r\n            // Не имеет смысла искать якорь при отсутсивии панели.\r\n            // FUTURE: если панели будут подгружаемыми, эту строку нужно изменить.\r\n        }\r\n\r\n        var anchor;\r\n\r\n        var search_anchor = function(node){\r\n            if (anchor === document.body)\r\n                return false;\r\n\r\n            if (name){\r\n                if (node.parentNode == document.body){\r\n                    console.warn('kenzo.popup: Якорь не найден');\r\n                    return false;\r\n                }\r\n                anchor = node.parentNode\r\n                    .querySelector('[data-kenzo-popup-anchor=\"' + name + '\"]');\r\n            } else {\r\n                anchor = node.parentNode\r\n                    .querySelector('[data-kenzo-popup-anchor]');\r\n            }\r\n\r\n            if (!anchor)\r\n                search_anchor(node.parentNode);\r\n        }\r\n\r\n        search_anchor(conductor);\r\n\r\n        conductor.addEventListener('click', function(event){\r\n            anchor.click();\r\n        });\r\n    });\r\n\r\n    // Кнопки и другие элементы для закрытия панели\r\n    each ('[data-kenzo-popup-close], [data-kenzo-popup-close-button]', function(item){\r\n        item.addEventListener('click', function(){\r\n            hide(item);\r\n        });\r\n    });\r\n\r\n    var is_popup = function(element){\r\n        if (element instanceof Element){\r\n            if (element === document.body) {\r\n                return false;\r\n            } else if (\r\n                element.hasAttribute('data-kenzo-popup-panel') ||\r\n                element.hasAttribute('data-kenzo-popup-anchor') ||\r\n                element.hasAttribute('data-kenzo-popup-conductor')\r\n            ){\r\n                return true;\r\n            } else if (element.parentNode !== document.body){\r\n                return is_popup(element.parentNode);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else if (element instanceof SVGElementInstance){\r\n            return is_popup(element.correspondingUseElement);\r\n        }\r\n    }\r\n\r\n    // Закрытие всех панелей по щелчку вне их;\r\n    document.addEventListener('click', function(event){\r\n        if (block_hide){\r\n            block_hide = false;\r\n            return false;\r\n        }\r\n\r\n        if ((current.length > 0) && (!is_popup(event.target))){\r\n            var len = current.length;\r\n            for (len; len > 0; len--){\r\n                hide(current[0].name, true);\r\n            }\r\n        }\r\n    });\r\n\r\n    return {\r\n        'get': get,\r\n        'show': show,\r\n        'hide': hide\r\n    }\r\n\r\n})();\r\n\r\n\r\n/*\r\n\r\nНабор элементов:\r\n    .kenzo-slider — корневой элемент слайдера\r\n        data-base-width=\"[ number ]\" — базовая ширина слайдера;\r\n        data-flipspeed=\"[ number ]\" — скорость анимации в секундах;\r\n        data-autoflip=\"[ number ]\" — период автоматического перелистывания в секундах;\r\n        data-distribution=\"[ number ]\" — распределяет в слайды то количество элементов, что указано.\r\n            Если атрибут отсутсвует, элементы распределяются, заполняя слайд до базовой ширины;\r\n        data-options=\"[ string ]\" — опции, разделены пробелами:\r\n            proportional-font-size — изменяет размер шрифта рамки пропорционально ширине слайдера;\r\n\r\n    .kenzo-slider__frame — рамка слайдера;\r\n    .kenzo-slider__container — контейнер (он же слайдер самолично);\r\n    .kenzo-slider__slide — слайд (генерируется скриптом);\r\n    .kenzo-slider__item — элемент слайдера (помещается скриптом в слайды);\r\n\r\n    .kenzo-slider__prev — элемент управления, листает слайды назад;\r\n    .kenzo-slider__next — элемент управления, листает слайды вперёд;\r\n\r\n    .kenzo-slider__indicator — элемент управления, показывает слайд,\r\n        соответсвующий порядковому номеру индикатора.\r\n\r\nСтруктура:\r\n    slider → frame → container → *slide* → item\r\n    slider → prev, next, indicator\r\n\r\n*/\r\nkenzo.slider = (function(){\r\n    var model = [],\r\n        defaults = {\r\n            'flipspeed': .4,\r\n            'autoflip': null,\r\n            'base_width': null,\r\n            'distribution': null,\r\n            'user_pause': 30\r\n        };\r\n\r\n    var add = function(block){\r\n\r\n        if (!(block instanceof Element) || (!block.classList.contains('kenzo-slider')))\r\n            return false;\r\n\r\n        var frame = block.querySelector('.kenzo-slider__frame');\r\n        if (frame === null) {console.warn('Отсутсвует рамка', block); return false }\r\n\r\n        var container = frame.querySelector('.kenzo-slider__container');\r\n        if (container === null) {console.warn('Отсутсвует контейнер', block); return false }\r\n\r\n        var items = container.querySelectorAll('.kenzo-slider__item');\r\n\r\n        if (!kenzo.is_nodes(items)){\r\n            console.warn('Отсутсвуют элементы', block);\r\n            return false;\r\n        }\r\n\r\n        var slides = [],\r\n            controls = {\r\n                prev: block.querySelector('.kenzo-slider__prev'),\r\n                next: block.querySelector('.kenzo-slider__next'),\r\n                indicators: block.querySelectorAll('.kenzo-slider__indicator')\r\n            },\r\n            settings = {\r\n                'flipspeed':\r\n                    parseFloat(block.getAttribute('data-flipspeed')) || defaults.flipspeed,\r\n                'autoflip':\r\n                    parseFloat(block.getAttribute('data-autoflip')) || defaults.autoflip,\r\n                'base_width':\r\n                    parseInt(block.getAttribute('data-base-width')) || defaults.base_width,\r\n                'distribution':\r\n                    parseInt(block.getAttribute('data-distribution')) || defaults.distribution\r\n            },\r\n            options = (function(){\r\n                var options = block.getAttribute('data-options');\r\n\r\n                if ((typeof options == 'string') && (options !== \"\")){\r\n                    options = options\r\n                        .replace(/(?:^|\\s)([^_a-zA-Z][\\w\\-]*)/g, '')\r\n                        .trim();\r\n                    options = options\r\n                        .split(' ')\r\n                        .sort();\r\n                }\r\n\r\n                if (!(options instanceof Array)) options = [];\r\n\r\n                return options;\r\n            })();\r\n\r\n        // Распределение элементов по слайдам\r\n        // Не пересчитывается при изменении размера рамки.\r\n        if (settings.distribution > 0){\r\n            var wrapper = document.createDocumentFragment(),\r\n                number_of_slides = Math.ceil(items.length / settings.distribution);\r\n\r\n            for (var slide_index = 0; slide_index < number_of_slides; slide_index++){\r\n                var slide = document.createElement('div');\r\n                slide.classList.add('kenzo-slider__slide');\r\n\r\n                for (\r\n                    var item_index = slide_index * settings.distribution;\r\n                    (item_index < (slide_index + 1) * settings.distribution)\r\n                        && (item_index < items.length);\r\n                    item_index++\r\n                ){\r\n                    slide.appendChild(items[item_index]);\r\n                }\r\n\r\n                slides.push(slide);\r\n                wrapper.appendChild(slide);\r\n            }\r\n            container.appendChild(wrapper);\r\n\r\n        } else if (settings.base_width > 0){\r\n            var width_sum = 0,\r\n                stack = [],\r\n                wrapper = document.createDocumentFragment();\r\n\r\n            each (items, function(item, i){\r\n                stack.push(item);\r\n                width_sum += item.offsetWidth;\r\n\r\n                if (\r\n                    (i + 1 === items.length) ||\r\n                    (width_sum + items[i + 1].offsetWidth > settings.base_width)\r\n                ){\r\n                    var\r\n                        k = width_sum / settings.base_width,\r\n                        slide = document.createElement('div');\r\n                    slide.classList.add('kenzo-slider__slide');\r\n\r\n                    if (k < .85)\r\n                        width_sum = Math.round(settings.base_width * .95);\r\n\r\n                    each (stack, function(e){\r\n                        e.style.width = (Math.floor(e.offsetWidth / width_sum * 10000) / 100) + '%';\r\n                        slide.appendChild(e);\r\n                    });\r\n\r\n                    stack = [];\r\n                    width_sum = 0;\r\n\r\n                    slides.push(slide);\r\n                    wrapper.appendChild(slide);\r\n                }\r\n            });\r\n\r\n            container.appendChild(wrapper);\r\n\r\n        } else {\r\n            console.warn('kenzo.slider:', 'Cледует указать либо базовую ширину,'\r\n                + ' либо количество элементов в слайде.');\r\n            return false;\r\n        }\r\n\r\n        // Индикаторы\r\n        if (kenzo.is_nodes(controls.indicators)){\r\n            for (var i = slides.length; i < controls.indicators.length; i++){\r\n                controls.indicators[i].parentNode.removeChild(controls.indicators[i]);\r\n            }\r\n\r\n            var wrapper = document.createDocumentFragment();\r\n\r\n            for (var i = controls.indicators.length; i < slides.length; i++){\r\n                wrapper.appendChild( controls.indicators[0].cloneNode() );\r\n            }\r\n\r\n            controls.indicators[0].parentNode.appendChild(wrapper);\r\n            controls.indicators = block.parentNode.querySelectorAll('.kenzo-slider__indicator');\r\n        } else {\r\n            controls.indicators = null;\r\n        }\r\n\r\n        model.push({\r\n            'dom': block,\r\n            'frame': frame,\r\n            'container': container,\r\n            'slides': slides,\r\n            'items': items,\r\n            'controls': controls,\r\n            'settings': settings,\r\n            'options': options,\r\n            'width': null,\r\n            'height': null,\r\n            'current': null\r\n        });\r\n\r\n        var index = model.length - 1;\r\n\r\n        choose(model[index], 0);\r\n        block.classList.add('activated');\r\n        set_flip_interval(model[index]);\r\n        set_transition(model[index]);\r\n\r\n        window.addEventListener('resize', function(){\r\n            update(model[index]);\r\n        });\r\n\r\n        if (controls.next instanceof Element)\r\n            controls.next.addEventListener('click', function(){ next(model[index], 'user') });\r\n        if (controls.prev instanceof Element)\r\n            controls.prev.addEventListener('click', function(){ prev(model[index], 'user') });\r\n\r\n        each (controls.indicators, function(indicator, i){\r\n            indicator.addEventListener('click', function(){ choose(model[index], i, 'user') });\r\n        });\r\n\r\n        each (slides, function(slide, i){\r\n            slide.addEventListener('click', function(){ choose(model[index], i, 'user') });\r\n        })\r\n    }\r\n\r\n    // Выбор слайда\r\n    var choose = function(block, slide, source){\r\n        if ((source == 'user') && (block.settings.flip_interval > 0)){\r\n            clearInterval(block.settings.flip_interval);\r\n            setTimeout(function(){\r\n                set_flip_interval(block);\r\n            }, defaults.user_pause * 1000);\r\n        }\r\n\r\n        var need_update = false;\r\n\r\n        if (block.current !== slide){\r\n            block.current = slide;\r\n            need_update = true;\r\n        }\r\n\r\n        need_update && update(block);\r\n    }\r\n\r\n    var next = function(block, source){\r\n        if ((block.current !== null) && (block.current + 1 < block.slides.length)){\r\n            choose(block, block.current + 1, source);\r\n        } else {\r\n            choose(block, 0, source);\r\n        }\r\n    }\r\n\r\n    var prev = function(block, source){\r\n        if ((block.current !== null) && (block.current - 1 >= 0)){\r\n            choose(block, block.current - 1, source);\r\n        } else {\r\n            choose(block, block.slides.length - 1, source);\r\n        }\r\n    }\r\n\r\n    // Установка периода перелистывания\r\n    var set_flip_interval = function(block){\r\n        if (block.settings.autoflip > 0){\r\n            clearInterval(block.settings.flip_interval);\r\n            block.settings.flip_interval = setInterval(function(){\r\n                next(block);\r\n            }, block.settings.autoflip * 1000);\r\n        }\r\n    }\r\n\r\n    var set_transition = function(block){\r\n        if (kenzo.browser === 'normal' || kenzo.browser === 'webkit'){\r\n            block.container.style.transitionDuration = block.settings.flipspeed + 's';\r\n            block.container.style.transitionTimingFunction = 'ease';\r\n\r\n            //block.frame.style.transitionDuration = flipspeed + 's';\r\n            //block.frame.style.transitionTimingFunction = 'ease';\r\n\r\n            if (kenzo.browser === 'normal') {\r\n                block.container.style.transitionProperty = 'transform';\r\n            } else if (kenzo.browser === 'webkit') {\r\n                block.container.style.transitionProperty = '-webkit-transform';\r\n            } else {\r\n                block.container.style.transitionProperty = 'left';\r\n            }\r\n\r\n            //block.frame.style.transitionProperty = 'height';\r\n        }\r\n    };\r\n\r\n    var update = function(block){\r\n        if (block.current === null) return false;\r\n\r\n        block.width = block.frame.offsetWidth;\r\n        each (block.slides, function(slide){\r\n            slide.style.width = block.width + 'px';\r\n        });\r\n\r\n        block.height = block.slides[block.current].offsetHeight;\r\n        block.container.style.width = block.width * block.slides.length + 'px';\r\n        block.frame.style.height = block.height + 'px';\r\n\r\n        // FIXME: Не учитывется поздняя загрузка изображений.\r\n\r\n//        if (block.height > 0){\r\n//            if (block.height > block.settings.base_max_height) {\r\n//                block.height = block.settings.base_max_height\r\n//            }\r\n//            if (block.height > block.frame.style.height) {\r\n//                block.frame.style.height = block.height + 'px';\r\n//            }\r\n//        }\r\n\r\n        if (\r\n            (block.options.indexOf('proportional-font-size') > -1) &&\r\n            (block.settings.base_width > 0)\r\n        )\r\n            block.frame.style.fontSize = block.width / block.settings.base_width + 'em';\r\n\r\n        if (kenzo.is_nodes(block.controls.indicators)){\r\n            each (block.controls.indicators, function(indicator, i){\r\n                if (i === block.current)\r\n                    indicator.classList.add('current');\r\n                else\r\n                    indicator.classList.remove('current');\r\n            });\r\n        }\r\n\r\n        var container_shift = -block.width * block.current + 'px',\r\n            container_transform = 'translate3d(' + container_shift + ', 0px, 0px)';\r\n\r\n        if (kenzo.browser == 'normal')\r\n            block.container.style.transform = container_transform;\r\n        else if (kenzo.browser == 'webkit')\r\n            block.container.style.webkitTransform = container_transform;\r\n        else\r\n            block.container.style.left = container_shift;\r\n\r\n        each (block.slides, function(slide, i){\r\n            if (i === block.current){\r\n                slide.classList.add('current');\r\n            } else {\r\n                slide.classList.remove('current');\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        'add': add\r\n    }\r\n})();\r\n\r\n\r\n/*\r\n\r\nНабор элементов:\r\n    .kenzo-scroll-content\r\n        data-name=\"[имя]\"\r\n    .kenzo-scroll-bar\r\n        data-name=\"[имя]\"\r\n        data-type=\"[dot | proportional]\"\r\n        data-orientation=\"[horizontal | vertical]\"\r\n    .kenzo-scroll-thumb\r\n        * должен находиться в элементе .kenzo-scroll-bar\r\n\r\n*/\r\nkenzo.scroller = (function(){\r\n    var\r\n        model = [],\r\n        current, current_bar, current_bar_type, last_pos;\r\n\r\n    var search_bar = function(child){\r\n        if (child.classList.contains('kenzo-scroll-bar'))\r\n            return child;\r\n        else if (child.parentNode !== document.body)\r\n            return search_bar(child.parentNode);\r\n    }\r\n\r\n    var mouse_capture = function(event){\r\n        if ((current !== null) && (current_bar !== null)) {\r\n            if (last_pos === null){\r\n                last_pos = event.clientX;\r\n                var offset = 0;\r\n            } else {\r\n                var offset = last_pos - event.clientX;\r\n                last_pos = event.clientX;\r\n            }\r\n\r\n            var thumb = current_bar.querySelector('.kenzo-scroll-thumb');\r\n\r\n            if (!current.pos) current.pos = 0;\r\n\r\n            if (current_bar_type == 'proportional'){\r\n                current.pos = (thumb.offsetLeft - offset) /\r\n                    (current_bar.offsetWidth - thumb.offsetWidth);\r\n            } else {\r\n                current.pos = (current.pos * current_bar.offsetWidth - offset) /\r\n                    (current_bar.offsetWidth - thumb.offsetWidth);\r\n            }\r\n\r\n            if (current.pos > 1)\r\n                current.pos = 1;\r\n            else if (current.pos < 0)\r\n                current.pos = 0;\r\n\r\n        } else {\r\n            stop_mouse_capture();\r\n        }\r\n\r\n        event.preventDefault();\r\n        update(current);\r\n    };\r\n\r\n    var stop_mouse_capture = function(){\r\n        if (current !== null){\r\n            current = null;\r\n            current_bar = null;\r\n            current_bar_type = null;\r\n            last_pos = null;\r\n            document.removeEventListener('mousemove', mouse_capture, true);\r\n        }\r\n    }\r\n\r\n    document.addEventListener('mouseup', stop_mouse_capture);\r\n\r\n    var add = function(element){\r\n        if (!(element instanceof Element)) return false;\r\n        var name = element.getAttribute('data-name');\r\n        if (name === null) return false;\r\n\r\n        if (element.classList.contains('kenzo-scroll-content')) {\r\n            each (model, function(item){\r\n                if (item.name === name){\r\n                    item.content.dom = element;\r\n                    return true;\r\n                }\r\n            }, function(){\r\n                model.push({\r\n                    'name': name,\r\n                    'pos': 0,\r\n                    'content': {\r\n                        'dom': element\r\n                    },\r\n                    'bars': []\r\n                });\r\n            });\r\n\r\n        } else if (element.classList.contains('kenzo-scroll-bar')) {\r\n            var\r\n                index,\r\n                thumb = element.querySelector('.kenzo-scroll-thumb'),\r\n                type = element.getAttribute('data-type');\r\n            each (model, function(item, i){\r\n                if (item.name === name){\r\n                    item.bars.push({\r\n                        'dom': element,\r\n                        'type': type,\r\n                        'thumb': {\r\n                            'dom': thumb\r\n                        }\r\n                    });\r\n\r\n                    index = i;\r\n                    return true;\r\n                }\r\n            }, function(){\r\n                if (!(thumb instanceof Element)) return false;\r\n\r\n                model.push({\r\n                    'name': name,\r\n                    'pos': 0,\r\n                    'content': {\r\n                        'dom': null\r\n                    },\r\n                    'bars': [{\r\n                        'dom': element,\r\n                        'type': type,\r\n                        'thumb': {\r\n                            'dom': thumb\r\n                        }\r\n                    }]\r\n                });\r\n\r\n                index = model.length - 1;\r\n            });\r\n\r\n            if (index === null) return false;\r\n\r\n            each (model[index].bars, function(bar){\r\n                bar.thumb.dom.addEventListener('mousedown', function(event){\r\n                    event.preventDefault();\r\n                    current = model[index];\r\n                    current_bar = search_bar(event.target);\r\n                    current_bar_type = bar.type;\r\n                    document.addEventListener('mousemove', mouse_capture, true);\r\n                }, true);\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    var update = function(){\r\n        each (model, function(){\r\n            var\r\n                name = arguments[0].name,\r\n                pos = arguments[0].pos,\r\n                content = arguments[0].content,\r\n                bars = arguments[0].bars;\r\n\r\n            if (\r\n                !(content.dom instanceof Element) ||\r\n                !(bars.length > 0)\r\n            ) return false;\r\n\r\n            if (content.dom.scrollWidth > content.dom.offsetWidth)\r\n                var show = true;\r\n            else\r\n                var show = false;\r\n\r\n            if (show){\r\n                if (pos === 0){\r\n                    content.dom.classList.remove('left');\r\n                    content.dom.classList.add('right');\r\n                } else if (pos === 1){\r\n                    content.dom.classList.add('left');\r\n                    content.dom.classList.remove('right');\r\n                } else {\r\n                    content.dom.classList.add('left');\r\n                    content.dom.classList.add('right');\r\n                }\r\n            } else {\r\n                content.dom.classList.remove('left');\r\n                content.dom.classList.remove('right');\r\n            }\r\n\r\n            each (bars, function(bar){\r\n                if (show){\r\n                    bar.dom.classList.remove('hidden');\r\n\r\n                    if (bar.type == 'proportional'){\r\n                    //bar.thumb.width =\r\n                    //    Math.round((content.dom.offsetWidth / content.dom.scrollWidth) *\r\n                    //        bar.dom.offsetWidth);\r\n\r\n                    //if (bar.thumb.width > 372)\r\n                        bar.thumb.width = 372;\r\n                    } else {\r\n                        bar.thumb.width = 0;\r\n                    }\r\n\r\n                    bar.thumb.dom.style.width = bar.thumb.width  + 'px';\r\n                    bar.thumb.dom.style.left =\r\n                        Math.round((bar.dom.offsetWidth - bar.thumb.width) * pos) + 'px';\r\n                } else {\r\n                    bar.dom.classList.add('hidden');\r\n                }\r\n            });\r\n\r\n            content.dom.scrollLeft =\r\n                Math.round((content.dom.scrollWidth - content.dom.offsetWidth) * pos);\r\n        });\r\n    }\r\n\r\n    each ('.kenzo-scroll-content', add);\r\n    each ('.kenzo-scroll-bar', add);\r\n\r\n    update();\r\n\r\n    window.addEventListener('resize', update);\r\n\r\n    return {\r\n        'add': add,\r\n        'update': update\r\n    }\r\n\r\n})();\r\n"],"sourceRoot":"/source/"}